import{h as e,o as l,b as t,i as o,V as a,K as n,f as i,_ as u,A as r,a5 as s,P as c,e as v,n as d,l as p,s as m,a as f,t as b,v as h,a6 as g,L as y,a7 as S}from"./bootstrap-DVYu9fpt.js";import{a as O,L as I,f as w,T as C,i as x,b as V,h as j,j as N,k as A,t as k,B as F,d as P,e as E,g as M}from"./index-CjqLwoBH.js";import{u as _}from"./move-BRk5kYHD.js";import{a2 as $,N as D,a1 as H,E as T,P as R,U as B,p as L,F as U,m as W,V as z,a3 as G,a6 as K,X,L as Q}from"../jse/index-index-BU8xCsxV.js";import{u as Y}from"./useMergedState-9GZCOMbf.js";import{u as Z,F as q}from"./FormItemContext-BbGFQEi0.js";import{g as J,a as ee}from"./statusUtils-BZaSczs9.js";import"./Trigger-DsfueF6c.js";import"./ResizeObserver.es-C7U_o75s.js";import"./BaseInput-RBOiHXEj.js";import"./Overflow-CVatm_Fz.js";import"./index-BKj9YvNs.js";import"./isMobile-VPrdNIIw.js";import"./DownOutlined-RI0_aJZK.js";import"./CheckOutlined-CUZ-dwuc.js";import"./SearchOutlined-CbNBPZoP.js";import"./slide-31UNvd4m.js";const le=Symbol("SelectContextKey");function te(e){return"string"==typeof e||"number"==typeof e}const oe=H({compatConfig:{MODE:3},name:"OptionList",inheritAttrs:!1,setup(i,u){let{expose:r,slots:s}=u;const c=O(),v=D(le,{}),d=T(()=>`${c.prefixCls}-item`),p=_(()=>v.flattenOptions,[()=>c.open,()=>v.flattenOptions],e=>e[0]),m=w(),f=e=>{e.preventDefault()},b=e=>{m.current&&m.current.scrollTo("number"==typeof e?{index:e}:e)},h=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const t=p.value.length;for(let o=0;o<t;o+=1){const a=(e+o*l+t)%t,{group:n,data:i}=p.value[a];if(!n&&!i.disabled)return a}return-1},g=R({activeIndex:h(0)}),y=function(e){let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];g.activeIndex=e;const t={source:l?"keyboard":"mouse"},o=p.value[e];o?v.onActiveValue(o.value,e,t):v.onActiveValue(null,-1,t)};B([()=>p.value.length,()=>c.searchValue],()=>{y(!1!==v.defaultActiveFirstOption?h(0):-1)},{immediate:!0});const S=e=>v.rawValues.has(e)&&"combobox"!==c.mode;B([()=>c.open,()=>c.searchValue],()=>{if(!c.multiple&&c.open&&1===v.rawValues.size){const e=Array.from(v.rawValues)[0],l=W(p.value).findIndex(l=>{let{data:t}=l;return t[v.fieldNames.value]===e});-1!==l&&(y(l),z(()=>{b(l)}))}c.open&&z(()=>{var e;null===(e=m.current)||void 0===e||e.scrollTo(void 0)})},{immediate:!0,flush:"post"});const x=e=>{void 0!==e&&v.onSelect(e,{selected:!v.rawValues.has(e)}),c.multiple||c.toggleOpen(!1)},V=e=>"function"==typeof e.label?e.label():e.label;function j(e){const l=p.value[e];if(!l)return null;const o=l.data||{},{value:n}=o,{group:i}=l,u=a(o,!0),r=V(l);return l?L("div",t(t({"aria-label":"string"!=typeof r||i?null:r},u),{},{key:e,role:i?"presentation":"option",id:`${c.id}_list_${e}`,"aria-selected":S(n)}),[n]):null}return r({onKeydown:e=>{const{which:l,ctrlKey:t}=e;switch(l){case n.N:case n.P:case n.UP:case n.DOWN:{let e=0;if(l===n.UP?e=-1:l===n.DOWN?e=1:/(mac\sos|macintosh)/i.test(navigator.appVersion)&&t&&(l===n.N?e=1:l===n.P&&(e=-1)),0!==e){const l=h(g.activeIndex+e,e);b(l),y(l,!0)}break}case n.ENTER:{const l=p.value[g.activeIndex];l&&!l.data.disabled?x(l.value):x(void 0),c.open&&e.preventDefault();break}case n.ESC:c.toggleOpen(!1),c.open&&e.stopPropagation()}},onKeyup:()=>{},scrollTo:e=>{b(e)}}),()=>{const{id:a,notFoundContent:n,onPopupScroll:i}=c,{menuItemSelectedIcon:u,fieldNames:r,virtual:b,listHeight:h,listItemHeight:O}=v,w=s.option,{activeIndex:N}=g,A=Object.keys(r).map(e=>r[e]);return 0===p.value.length?L("div",{role:"listbox",id:`${a}_list`,class:`${d.value}-empty`,onMousedown:f},[n]):L(U,null,[L("div",{role:"listbox",id:`${a}_list`,style:{height:0,width:0,overflow:"hidden"}},[j(N-1),j(N),j(N+1)]),L(I,{itemKey:"key",ref:m,data:p.value,height:h,itemHeight:O,fullHeight:!1,onMousedown:f,onScroll:i,virtual:b},{default:(a,n)=>{var i;const{group:r,groupOption:s,data:c,value:v}=a,{key:p}=c,m="function"==typeof a.label?a.label():a.label;if(r){const l=null!==(i=c.title)&&void 0!==i?i:te(m)&&m;return L("div",{class:e(d.value,`${d.value}-group`),title:l},[w?w(c):void 0!==m?m:p])}const{disabled:f,title:b,children:h,style:g,class:O,className:I}=c,j=function(e,l){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&l.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)l.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(t[o[a]]=e[o[a]])}return t}(c,["disabled","title","children","style","class","className"]),k=l(j,A),F=S(v),P=`${d.value}-option`,E=e(d.value,P,O,I,{[`${P}-grouped`]:s,[`${P}-active`]:N===n&&!f,[`${P}-disabled`]:f,[`${P}-selected`]:F}),M=V(a),_=!u||"function"==typeof u||F,$="number"==typeof M?M:M||v;let D=te($)?$.toString():void 0;return void 0!==b&&(D=b),L("div",t(t({},k),{},{"aria-selected":F,class:E,title:D,onMousemove:e=>{j.onMousemove&&j.onMousemove(e),N===n||f||y(n)},onClick:e=>{f||x(v),j.onClick&&j.onClick(e)},style:g}),[L("div",{class:`${P}-content`},[w?w(c):$]),o(u)||F,_&&L(C,{class:`${d.value}-option-state`,customizeIcon:u,customizeIconProps:{isSelected:F}},{default:()=>[F?"âœ“":null]})])}})])}}});function ae(e){const l=e,{key:t,children:o}=l,a=l.props,{value:n,disabled:i}=a,r=function(e,l){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&l.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)l.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(t[o[a]]=e[o[a]])}return t}(a,["value","disabled"]),s=null==o?void 0:o.default;return u({key:t,value:void 0!==n?n:t,children:s,disabled:i||""===i},r)}function ne(e){let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return i(e).map((e,t)=>{var a;if(!o(e)||!e.type)return null;const{type:{isSelectOptGroup:n},key:i,children:r,props:s}=e;if(l||!n)return ae(e);const c=r&&r.default?r.default():void 0,v=(null==s?void 0:s.label)||(null===(a=r.label)||void 0===a?void 0:a.call(r))||i;return u(u({key:`__RC_SELECT_GRP__${null===i?t:String(i)}__`},s),{label:v,options:ne(c||[])})}).filter(e=>e)}function ie(e,l,t){const o=G(),a=G(),n=G(),i=G([]);return B([e,l],()=>{e.value?i.value=W(e.value).slice():i.value=ne(l.value)},{immediate:!0,deep:!0}),K(()=>{const e=i.value,l=new Map,u=new Map,r=t.value;!function e(t){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(let a=0;a<t.length;a+=1){const n=t[a];!n[r.options]||o?(l.set(n[r.value],n),u.set(n[r.label],n)):e(n[r.options],!0)}}(e),o.value=e,a.value=l,n.value=u}),{options:o,valueOptions:a,labelOptions:n}}function ue(e){return Array.isArray(e)?e:void 0!==e?[e]:[]}function re(e,l){return ue(e).join("").toUpperCase().includes(l)}const se=["inputValue"];function ce(){return u(u({},P()),{prefixCls:String,id:String,backfill:{type:Boolean,default:void 0},fieldNames:Object,inputValue:String,searchValue:String,onSearch:Function,autoClearSearchValue:{type:Boolean,default:void 0},onSelect:Function,onDeselect:Function,filterOption:{type:[Boolean,Function],default:void 0},filterSort:Function,optionFilterProp:String,optionLabelProp:String,options:Array,defaultActiveFirstOption:{type:Boolean,default:void 0},virtual:{type:Boolean,default:void 0},listHeight:Number,listItemHeight:Number,menuItemSelectedIcon:c.any,mode:String,labelInValue:{type:Boolean,default:void 0},value:c.any,defaultValue:c.any,onChange:Function,children:Array})}const ve=H({compatConfig:{MODE:3},name:"VcSelect",inheritAttrs:!1,props:r(ce(),{prefixCls:"vc-select",autoClearSearchValue:!0,listHeight:200,listItemHeight:20,dropdownMatchSelectWidth:!0}),setup(e,o){let{expose:a,attrs:n,slots:i}=o;const r=V(X(e,"id")),c=T(()=>j(e.mode)),v=T(()=>!(e.options||!e.children)),d=T(()=>(void 0!==e.filterOption||"combobox"!==e.mode)&&e.filterOption),p=T(()=>N(e.fieldNames,v.value)),[m,f]=Y("",{value:T(()=>void 0!==e.searchValue?e.searchValue:e.inputValue),postState:e=>e||""}),b=ie(X(e,"options"),X(e,"children"),p),{valueOptions:h,labelOptions:g,options:y}=b,S=l=>ue(l).map(l=>{var t,o;let a,n,i,u;var r;(r=l)&&"object"==typeof r?(i=l.key,n=l.label,a=null!==(t=l.value)&&void 0!==t?t:i):a=l;const s=h.value.get(a);return s&&(void 0===n&&(n=null==s?void 0:s[e.optionLabelProp||p.value.label]),void 0===i&&(i=null!==(o=null==s?void 0:s.key)&&void 0!==o?o:a),u=null==s?void 0:s.disabled),{label:n,value:a,key:i,disabled:u,option:s}}),[O,I]=Y(e.defaultValue,{value:X(e,"value")}),w=T(()=>{var l;const t=S(O.value);return"combobox"!==e.mode||(null===(l=t[0])||void 0===l?void 0:l.value)?t:[]}),[C,P]=((e,l)=>{const t=G({values:new Map,options:new Map});return[T(()=>{const{values:o,options:a}=t.value,n=e.value.map(e=>{var l;return void 0===e.label?u(u({},e),{label:null===(l=o.get(e.value))||void 0===l?void 0:l.label}):e}),i=new Map,r=new Map;return n.forEach(e=>{i.set(e.value,e),r.set(e.value,l.value.get(e.value)||a.get(e.value))}),t.value.values=i,t.value.options=r,n}),e=>l.value.get(e)||t.value.options.get(e)]})(w,h),E=T(()=>{if(!e.mode&&1===C.value.length){const e=C.value[0];if(null===e.value&&(null===e.label||void 0===e.label))return[]}return C.value.map(e=>{var l;return u(u({},e),{label:null!==(l="function"==typeof e.label?e.label():e.label)&&void 0!==l?l:e.value})})}),M=T(()=>new Set(C.value.map(e=>e.value)));K(()=>{var l;if("combobox"===e.mode){const e=null===(l=C.value[0])||void 0===l?void 0:l.value;null!=e&&f(String(e))}},{flush:"post"});const _=(e,l)=>{const t=null!=l?l:e;return{[p.value.value]:e,[p.value.label]:t}},D=G();K(()=>{if("tags"!==e.mode)return void(D.value=y.value);const l=y.value.slice();[...C.value].sort((e,l)=>e.value<l.value?-1:1).forEach(e=>{const t=e.value;(e=>h.value.has(e))(t)||l.push(_(t,e.label))}),D.value=l});const H=(R=D,B=p,U=m,W=d,z=X(e,"optionFilterProp"),T(()=>{const e=U.value,l=null==z?void 0:z.value,t=null==W?void 0:W.value;if(!e||!1===t)return R.value;const{options:o,label:a,value:n}=B.value,i=[],r="function"==typeof t,s=e.toUpperCase(),c=r?t:(e,t)=>l?re(t[l],s):t[o]?re(t["children"!==a?a:"label"],s):re(t[n],s),v=r?e=>x(e):e=>e;return R.value.forEach(l=>{if(l[o])if(c(e,v(l)))i.push(l);else{const t=l[o].filter(l=>c(e,v(l)));t.length&&i.push(u(u({},l),{[o]:t}))}else c(e,v(l))&&i.push(l)}),i}));var R,B,U,W,z;const Z=T(()=>"tags"!==e.mode||!m.value||H.value.some(l=>l[e.optionFilterProp||"value"]===m.value)?H.value:[_(m.value),...H.value]),q=T(()=>e.filterSort?[...Z.value].sort((l,t)=>e.filterSort(l,t)):Z.value),J=T(()=>A(q.value,{fieldNames:p.value,childrenAsData:v.value})),ee=l=>{const t=S(l);if(I(t),e.onChange&&(t.length!==C.value.length||t.some((e,l)=>{var t;return(null===(t=C.value[l])||void 0===t?void 0:t.value)!==(null==e?void 0:e.value)}))){const l=e.labelInValue?t.map(e=>u(u({},e),{originLabel:e.label,label:"function"==typeof e.label?e.label():e.label})):t.map(e=>e.value),o=t.map(e=>x(P(e.value)));e.onChange(c.value?l:l[0],c.value?o:o[0])}},[te,ae]=s(null),[ne,ce]=s(0),ve=T(()=>void 0!==e.defaultActiveFirstOption?e.defaultActiveFirstOption:"combobox"!==e.mode),de=(l,t)=>{const o=()=>{var t;const o=P(l),a=null==o?void 0:o[p.value.label];return[e.labelInValue?{label:"function"==typeof a?a():a,originLabel:a,value:l,key:null!==(t=null==o?void 0:o.key)&&void 0!==t?t:l}:l,x(o)]};if(t&&e.onSelect){const[l,t]=o();e.onSelect(l,t)}else if(!t&&e.onDeselect){const[l,t]=o();e.onDeselect(l,t)}},pe=(e,l)=>{ee(e),"remove"!==l.type&&"clear"!==l.type||l.values.forEach(e=>{de(e.value,!1)})},me=(l,t)=>{var o;if(f(l),ae(null),"submit"===t.source){const e=(l||"").trim();if(e){const l=Array.from(new Set([...M.value,e]));ee(l),de(e,!0),f("")}return}"blur"!==t.source&&("combobox"===e.mode&&ee(l),null===(o=e.onSearch)||void 0===o||o.call(e,l))},fe=l=>{let t=l;"tags"!==e.mode&&(t=l.map(e=>{const l=g.value.get(e);return null==l?void 0:l.value}).filter(e=>void 0!==e));const o=Array.from(new Set([...M.value,...t]));ee(o),o.forEach(e=>{de(e,!0)})},be=T(()=>!1!==e.virtual&&!1!==e.dropdownMatchSelectWidth);!function(e){$(le,e)}(k(u(u({},b),{flattenOptions:J,onActiveValue:function(l,t){let{source:o="keyboard"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};ce(t),e.backfill&&"combobox"===e.mode&&null!==l&&"keyboard"===o&&ae(String(l))},defaultActiveFirstOption:ve,onSelect:(l,t)=>{let o;const a=!c.value||t.selected;o=a?c.value?[...C.value,l]:[l]:C.value.filter(e=>e.value!==l),ee(o),de(l,a),"combobox"===e.mode?ae(""):c.value&&!e.autoClearSearchValue||(f(""),ae(""))},menuItemSelectedIcon:X(e,"menuItemSelectedIcon"),rawValues:M,fieldNames:p,virtual:be,listHeight:X(e,"listHeight"),listItemHeight:X(e,"listItemHeight"),childrenAsData:v})));const he=Q();a({focus(){var e;null===(e=he.value)||void 0===e||e.focus()},blur(){var e;null===(e=he.value)||void 0===e||e.blur()},scrollTo(e){var l;null===(l=he.value)||void 0===l||l.scrollTo(e)}});const ge=T(()=>l(e,["id","mode","prefixCls","backfill","fieldNames","inputValue","searchValue","onSearch","autoClearSearchValue","onSelect","onDeselect","dropdownMatchSelectWidth","filterOption","filterSort","optionFilterProp","optionLabelProp","options","children","defaultActiveFirstOption","menuItemSelectedIcon","virtual","listHeight","listItemHeight","value","defaultValue","labelInValue","onChange"]));return()=>L(F,t(t(t({},ge.value),n),{},{id:r,prefixCls:e.prefixCls,ref:he,omitDomProps:se,mode:e.mode,displayValues:E.value,onDisplayValuesChange:pe,searchValue:m.value,onSearch:me,onSearchSplit:fe,dropdownMatchSelectWidth:e.dropdownMatchSelectWidth,OptionList:oe,emptyOptions:!J.value.length,activeValue:te.value,activeDescendantId:`${r}_list_${ne.value}`}),i)}}),de=()=>null;de.isSelectOption=!0,de.displayName="ASelectOption";const pe=()=>null;pe.isSelectOptGroup=!0,pe.displayName="ASelectOptGroup";const me=()=>u(u({},l(ce(),["inputIcon","mode","getInputElement","getRawInputElement","backfill"])),{value:m([Array,Object,String,Number]),defaultValue:m([Array,Object,String,Number]),notFoundContent:c.any,suffixIcon:c.any,itemIcon:c.any,size:d(),mode:d(),bordered:p(!0),transitionName:String,choiceTransitionName:d(""),popupClassName:String,dropdownClassName:String,placement:d(),status:d(),"onUpdate:value":v()}),fe="SECRET_COMBOBOX_MODE_DO_NOT_USE",be=H({compatConfig:{MODE:3},name:"ASelect",Option:de,OptGroup:pe,inheritAttrs:!1,props:r(me(),{listHeight:256,listItemHeight:24}),SECRET_COMBOBOX_MODE_DO_NOT_USE:fe,slots:Object,setup(o,a){let{attrs:n,emit:i,slots:r,expose:s}=a;const c=Q(),v=Z(),d=q.useInject(),p=T(()=>J(d.status,o.status)),m=T(()=>{const{mode:e}=o;if("combobox"!==e)return e===fe?"combobox":e}),{prefixCls:O,direction:I,renderEmpty:w,size:C,getPrefixCls:x,getPopupContainer:V,disabled:j,select:N}=f("select",o),{compactSize:A,compactItemClassnames:k}=b(O,I),F=T(()=>A.value||C.value),P=h(),_=T(()=>{var e;return null!==(e=j.value)&&void 0!==e?e:P.value}),[$,D]=E(O),H=T(()=>x()),R=T(()=>void 0!==o.placement?o.placement:"rtl"===I.value?"bottomRight":"bottomLeft"),B=T(()=>g(H.value,y(R.value),o.transitionName)),U=T(()=>e({[`${O.value}-lg`]:"large"===F.value,[`${O.value}-sm`]:"small"===F.value,[`${O.value}-rtl`]:"rtl"===I.value,[`${O.value}-borderless`]:!o.bordered,[`${O.value}-in-form-item`]:d.isFormItemInput},ee(O.value,p.value,d.hasFeedback),k.value,D.value)),W=function(){for(var e=arguments.length,l=new Array(e),t=0;t<e;t++)l[t]=arguments[t];i("update:value",l[0]),i("change",...l),v.onFieldChange()},z=e=>{i("blur",e),v.onFieldBlur()};s({blur:()=>{var e;null===(e=c.value)||void 0===e||e.blur()},focus:()=>{var e;null===(e=c.value)||void 0===e||e.focus()},scrollTo:e=>{var l;null===(l=c.value)||void 0===l||l.scrollTo(e)}});const G=T(()=>"multiple"===m.value||"tags"===m.value),K=T(()=>void 0!==o.showArrow?o.showArrow:o.loading||!(G.value||"combobox"===m.value));return()=>{var a,i,s,p;const{notFoundContent:f,listHeight:b=256,listItemHeight:h=24,popupClassName:g,dropdownClassName:y,virtual:C,dropdownMatchSelectWidth:x,id:j=v.id.value,placeholder:A=(null===(a=r.placeholder)||void 0===a?void 0:a.call(r)),showArrow:k}=o,{hasFeedback:F,feedbackIcon:P}=d;let E;E=void 0!==f?f:r.notFoundContent?r.notFoundContent():"combobox"===m.value?null:(null==w?void 0:w("Select"))||L(S,{componentName:"Select"},null);const{suffixIcon:H,itemIcon:T,removeIcon:R,clearIcon:X}=M(u(u({},o),{multiple:G.value,prefixCls:O.value,hasFeedback:F,feedbackIcon:P,showArrow:K.value}),r),Q=l(o,["prefixCls","suffixIcon","itemIcon","removeIcon","clearIcon","size","bordered","status"]),Y=e(g||y,{[`${O.value}-dropdown-${I.value}`]:"rtl"===I.value},D.value);return $(L(ve,t(t(t({ref:c,virtual:C,dropdownMatchSelectWidth:x},Q),n),{},{showSearch:null!==(i=o.showSearch)&&void 0!==i?i:null===(s=null==N?void 0:N.value)||void 0===s?void 0:s.showSearch,placeholder:A,listHeight:b,listItemHeight:h,mode:m.value,prefixCls:O.value,direction:I.value,inputIcon:H,menuItemSelectedIcon:T,removeIcon:R,clearIcon:X,notFoundContent:E,class:[U.value,n.class],getPopupContainer:null==V?void 0:V.value,dropdownClassName:Y,onChange:W,onBlur:z,id:j,dropdownRender:Q.dropdownRender||r.dropdownRender,transitionName:B.value,children:null===(p=r.default)||void 0===p?void 0:p.call(r),tagRender:o.tagRender||r.tagRender,optionLabelRender:r.optionLabel,maxTagPlaceholder:o.maxTagPlaceholder||r.maxTagPlaceholder,showArrow:F||k,disabled:_.value}),{option:r.option}))}}});be.install=function(e){return e.component(be.name,be),e.component(be.Option.displayName,be.Option),e.component(be.OptGroup.displayName,be.OptGroup),e};const he=be.Option,ge=be.OptGroup;export{ge as SelectOptGroup,he as SelectOption,be as default,me as selectProps};
