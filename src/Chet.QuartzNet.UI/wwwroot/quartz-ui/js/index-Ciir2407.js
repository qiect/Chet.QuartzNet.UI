import{y as e,P as t,_ as o,z as n,A as i,o as a,h as r,b as l,K as s,B as u,C as d,g as p,r as c,D as f,a as v,f as g,E as m}from"./bootstrap-DXlrt1hk.js";import{T as h}from"./Trigger-BVSwsstg.js";import{M as b,a as x,u as y}from"./index-CDI1x9Go.js";import{S}from"./index-BIxk0I2C.js";import{a1 as C,N as w,a3 as O,a8 as j,p as P,E as F,L as I,P as E,a6 as $,a2 as T,X as N,o as R,V as k,U as z}from"../jse/index-index-DYXaZXJd.js";import{B}from"./BaseInput-CjL79ovR.js";import{u as A,F as L}from"./FormItemContext-D3lYv0Zr.js";import{g as M,a as H}from"./statusUtils-BzySqC6e.js";import{i as D,g as W,a as V,b as U,e as K,d as X}from"./index-DbIiIKJF.js";import"./ResizeObserver.es-C7U_o75s.js";import"./shallowequal-_Nx1GofK.js";import"./_arrayIncludes-DqeOlflt.js";import"./Overflow-B1evrgHo.js";import"./index-CHp-6w-c.js";import"./index-DmF-2_j7.js";import"./colors-BF59G2Ax.js";import"./collapseMotion-kmSjL8PD.js";import"./slide-yHt8bV66.js";function Y(e){return(e||"").toLowerCase()}function _(e,t){const{measureLocation:o,prefix:n,targetText:i,selectionStart:a,split:r}=t;let l=e.slice(0,o);l[l.length-r.length]===r&&(l=l.slice(0,l.length-r.length)),l&&(l=`${l}${r}`);let s=function(e,t,o){const n=e[0];if(!n||n===o)return e;let i=e;const a=t.length;for(let r=0;r<a;r+=1){if(Y(i[r])!==Y(t[r])){i=i.slice(r);break}r===a-1&&(i=i.slice(a))}return i}(e.slice(a),i.slice(a-o-n.length),r);s.slice(0,r.length)===r&&(s=s.slice(r.length));const u=`${l}${n}${i}${r}`;return{text:`${u}${s}`,selectionLocation:u.length}}function G(e,t){let{value:o=""}=t;const n=e.toLowerCase();return-1!==o.toLowerCase().indexOf(n)}const q=Symbol("MentionsContextKey");function Q(){}const Z=C({compatConfig:{MODE:3},name:"DropdownMenu",props:{prefixCls:String,options:{type:Array,default:()=>[]}},setup(e,t){let{slots:o}=t;const{activeIndex:n,setActiveIndex:i,selectOption:a,onFocus:r=Q,loading:l}=w(q,{activeIndex:O(),loading:O(!1)});let s;const u=e=>{clearTimeout(s),s=setTimeout(()=>{r(e)})};return j(()=>{clearTimeout(s)}),()=>{var t;const{prefixCls:r,options:s}=e,d=s[n.value]||{};return P(b,{prefixCls:`${r}-menu`,activeKey:d.value,onSelect:e=>{let{key:t}=e;const o=s.find(e=>{let{value:o}=e;return o===t});a(o)},onMousedown:u},{default:()=>[!l.value&&s.map((e,t)=>{var n,a;const{value:r,disabled:l,label:s=e.value,class:u,style:d}=e;return P(x,{key:r,disabled:l,onMouseenter:()=>{i(t)},class:u,style:d},{default:()=>[null!==(a=null===(n=o.option)||void 0===n?void 0:n.call(o,e))&&void 0!==a?a:"function"==typeof s?s(e):s]})}),l.value||0!==s.length?null:P(x,{key:"notFoundContent",disabled:!0},{default:()=>[null===(t=o.notFoundContent)||void 0===t?void 0:t.call(o)]}),l.value&&P(x,{key:"loading",disabled:!0},{default:()=>[P(S,{size:"small"},null)]})]})}}}),J={bottomRight:{points:["tl","br"],offset:[0,4],overflow:{adjustX:0,adjustY:1}},bottomLeft:{points:["tr","bl"],offset:[0,4],overflow:{adjustX:0,adjustY:1}},topRight:{points:["bl","tr"],offset:[0,-4],overflow:{adjustX:0,adjustY:1}},topLeft:{points:["br","tl"],offset:[0,-4],overflow:{adjustX:0,adjustY:1}}},ee=C({compatConfig:{MODE:3},name:"KeywordTrigger",props:{loading:{type:Boolean,default:void 0},options:{type:Array,default:()=>[]},prefixCls:String,placement:String,visible:{type:Boolean,default:void 0},transitionName:String,getPopupContainer:Function,direction:String,dropdownClassName:String},setup(e,t){let{slots:o}=t;const n=()=>`${e.prefixCls}-dropdown`,i=()=>{const{options:t}=e;return P(Z,{prefixCls:n(),options:t},{notFoundContent:o.notFoundContent,option:o.option})},a=F(()=>{const{placement:t,direction:o}=e;let n="topRight";return n="rtl"===o?"top"===t?"topLeft":"bottomLeft":"top"===t?"topRight":"bottomRight",n});return()=>{const{visible:t,transitionName:r,getPopupContainer:l}=e;return P(h,{prefixCls:n(),popupVisible:t,popup:i(),popupClassName:e.dropdownClassName,popupPlacement:a.value,popupTransitionName:r,builtinPlacements:J,getPopupContainer:l},{default:o.default})}}}),te=n("top","bottom"),oe={autofocus:{type:Boolean,default:void 0},prefix:t.oneOfType([t.string,t.arrayOf(t.string)]),prefixCls:String,value:String,disabled:{type:Boolean,default:void 0},split:String,transitionName:String,placement:t.oneOf(te),character:t.any,characterRender:Function,filterOption:{type:[Boolean,Function]},validateSearch:Function,getPopupContainer:{type:Function},options:e(),loading:{type:Boolean,default:void 0},rows:[Number,String],direction:{type:String}},ne=o(o({},oe),{dropdownClassName:String}),ie={prefix:"@",split:" ",rows:1,validateSearch:function(e,t){const{split:o}=t;return!o||-1===e.indexOf(o)},filterOption:()=>G};i(ne,ie);var ae=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(o[n[i]]=e[n[i]])}return o};function re(){}const le=C({compatConfig:{MODE:3},name:"Mentions",inheritAttrs:!1,props:i(ne,ie),emits:["change","select","search","focus","blur","pressenter"],setup(e,t){let{emit:n,attrs:i,expose:u,slots:d}=t;const p=I(null),c=I(null),f=I(),v=E({value:e.value||"",measuring:!1,measureLocation:0,measureText:null,measurePrefix:"",activeIndex:0,isFocus:!1});$(()=>{v.value=e.value});const g=e=>{n("change",e)},m=e=>{let{target:{value:t}}=e;g(t)},h=e=>{o(v,{measuring:!1,measureLocation:0,measureText:null}),null==e||e()},b=e=>{const{which:t}=e;if(v.measuring)if(t===s.UP||t===s.DOWN){const o=A.value.length,n=t===s.UP?-1:1,i=(v.activeIndex+n+o)%o;v.activeIndex=i,e.preventDefault()}else if(t===s.ESC)h();else if(t===s.ENTER){if(e.preventDefault(),!A.value.length)return void h();const t=A.value[v.activeIndex];j(t)}},x=t=>{const{key:i,which:a}=t,{measureText:r,measuring:l}=v,{prefix:u,validateSearch:d}=e,p=t.target;if(p.composing)return;const c=function(e){const{selectionStart:t}=e;return e.value.slice(0,t)}(p),{location:f,prefix:g}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Array.isArray(t)?t:[t]).reduce((t,o)=>{const n=e.lastIndexOf(o);return n>t.location?{location:n,prefix:o}:t},{location:-1,prefix:""})}(c,u);if(-1===[s.ESC,s.UP,s.DOWN,s.ENTER].indexOf(a))if(-1!==f){const t=c.slice(f+g.length),a=d(t,e),s=!!z(t).length;a?(i===g||"Shift"===i||l||t!==r&&s)&&((e,t,n)=>{o(v,{measuring:!0,measureText:e,measurePrefix:t,measureLocation:n,activeIndex:0})})(t,g,f):l&&h(),a&&n("search",t,g)}else l&&h()},y=e=>{v.measuring||n("pressenter",e)},S=e=>{w(e)},C=e=>{O(e)},w=e=>{clearTimeout(f.value);const{isFocus:t}=v;!t&&e&&n("focus",e),v.isFocus=!0},O=e=>{f.value=setTimeout(()=>{v.isFocus=!1,h(),n("blur",e)},100)},j=t=>{const{split:o}=e,{value:i=""}=t,{text:a,selectionLocation:r}=_(v.value,{measureLocation:v.measureLocation,targetText:i,prefix:v.measurePrefix,selectionStart:c.value.getSelectionStart(),split:o});g(a),h(()=>{var e,t;e=c.value.input,t=r,e.setSelectionRange(t,t),e.blur(),e.focus()}),n("select",t,v.measurePrefix)},z=t=>{const o=t||v.measureText||"",{filterOption:n}=e;return e.options.filter(e=>!1==!!n||n(o,e))},A=F(()=>z());return u({blur:()=>{c.value.blur()},focus:()=>{c.value.focus()}}),T(q,{activeIndex:N(v,"activeIndex"),setActiveIndex:e=>{v.activeIndex=e},selectOption:j,onFocus:w,onBlur:O,loading:N(e,"loading")}),R(()=>{k(()=>{v.measuring&&(p.value.scrollTop=c.value.getScrollTop())})}),()=>{const{measureLocation:t,measurePrefix:n,measuring:s}=v,{prefixCls:u,placement:f,transitionName:g,getPopupContainer:h,direction:w}=e,O=ae(e,["prefixCls","placement","transitionName","getPopupContainer","direction"]),{class:j,style:F}=i,I=ae(i,["class","style"]),E=a(O,["value","prefix","split","validateSearch","filterOption","options","loading"]),$=o(o(o({},E),I),{onChange:re,onSelect:re,value:v.value,onInput:m,onBlur:C,onKeydown:b,onKeyup:x,onFocus:S,onPressenter:y});return P("div",{class:r(u,j),style:F},[P(B,l(l({},$),{},{ref:c,tag:"textarea"}),null),s&&P("div",{ref:p,class:`${u}-measure`},[v.value.slice(0,t),P(ee,{prefixCls:u,transitionName:g,dropdownClassName:e.dropdownClassName,placement:f,options:s?A.value:[],visible:!0,direction:w,getPopupContainer:h},{default:()=>[P("span",null,[n])],notFoundContent:d.notFoundContent,option:d.option}),v.value.slice(t+n.length)])])}}}),se={value:String,disabled:Boolean,payload:u()},ue=o(o({},se),{label:d([])}),de={name:"Option",props:ue,render(e,t){let{slots:o}=t;var n;return null===(n=o.default)||void 0===n?void 0:n.call(o)}};C(o({compatConfig:{MODE:3}},de));const pe=e=>{const{componentCls:t,colorTextDisabled:n,controlItemBgHover:i,controlPaddingHorizontal:a,colorText:r,motionDurationSlow:l,lineHeight:s,controlHeight:u,inputPaddingHorizontal:d,inputPaddingVertical:p,fontSize:v,colorBgElevated:g,borderRadiusLG:m,boxShadowSecondary:h}=e,b=Math.round((e.controlHeight-e.fontSize*e.lineHeight)/2);return{[t]:o(o(o(o(o({},c(e)),W(e)),{position:"relative",display:"inline-block",height:"auto",padding:0,overflow:"hidden",lineHeight:s,whiteSpace:"pre-wrap",verticalAlign:"bottom"}),V(e,t)),{"&-disabled":{"> textarea":o({},X(e))},"&-focused":o({},K(e)),[`&-affix-wrapper ${t}-suffix`]:{position:"absolute",top:0,insetInlineEnd:d,bottom:0,zIndex:1,display:"inline-flex",alignItems:"center",margin:"auto"},[`> textarea, ${t}-measure`]:{color:r,boxSizing:"border-box",minHeight:u-2,margin:0,padding:`${p}px ${d}px`,overflow:"inherit",overflowX:"hidden",overflowY:"auto",fontWeight:"inherit",fontSize:"inherit",fontFamily:"inherit",fontStyle:"inherit",fontVariant:"inherit",fontSizeAdjust:"inherit",fontStretch:"inherit",lineHeight:"inherit",direction:"inherit",letterSpacing:"inherit",whiteSpace:"inherit",textAlign:"inherit",verticalAlign:"top",wordWrap:"break-word",wordBreak:"inherit",tabSize:"inherit"},"> textarea":o({width:"100%",border:"none",outline:"none",resize:"none",backgroundColor:"inherit"},U(e.colorTextPlaceholder)),[`${t}-measure`]:{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:-1,color:"transparent",pointerEvents:"none","> span":{display:"inline-block",minHeight:"1em"}},"&-dropdown":o(o({},c(e)),{position:"absolute",top:-9999,insetInlineStart:-9999,zIndex:e.zIndexPopup,boxSizing:"border-box",fontSize:v,fontVariant:"initial",backgroundColor:g,borderRadius:m,outline:"none",boxShadow:h,"&-hidden":{display:"none"},[`${t}-dropdown-menu`]:{maxHeight:e.dropdownHeight,marginBottom:0,paddingInlineStart:0,overflow:"auto",listStyle:"none",outline:"none","&-item":o(o({},f),{position:"relative",display:"block",minWidth:e.controlItemWidth,padding:`${b}px ${a}px`,color:r,fontWeight:"normal",lineHeight:s,cursor:"pointer",transition:`background ${l} ease`,"&:hover":{backgroundColor:i},"&:first-child":{borderStartStartRadius:m,borderStartEndRadius:m,borderEndStartRadius:0,borderEndEndRadius:0},"&:last-child":{borderStartStartRadius:0,borderStartEndRadius:0,borderEndStartRadius:m,borderEndEndRadius:m},"&-disabled":{color:n,cursor:"not-allowed","&:hover":{color:n,backgroundColor:i,cursor:"not-allowed"}},"&-selected":{color:r,fontWeight:e.fontWeightStrong,backgroundColor:i},"&-active":{backgroundColor:i}})}})})}},ce=p("Mentions",e=>{const t=D(e);return[pe(t)]},e=>({dropdownHeight:250,controlItemWidth:100,zIndexPopup:e.zIndexPopupBase+50}));var fe=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(o[n[i]]=e[n[i]])}return o};function ve(){return!0}const ge=()=>o(o({},oe),{loading:{type:Boolean,default:void 0},onFocus:{type:Function},onBlur:{type:Function},onSelect:{type:Function},onChange:{type:Function},onPressenter:{type:Function},"onUpdate:value":{type:Function},notFoundContent:t.any,defaultValue:String,id:String,status:String}),me=C({compatConfig:{MODE:3},name:"AMentions",inheritAttrs:!1,props:ge(),slots:Object,setup(e,t){let{slots:n,emit:i,attrs:s,expose:u}=t;var d,p;const{prefixCls:c,renderEmpty:f,direction:h}=v("mentions",e),[b,x]=ce(c),C=O(!1),w=O(null),j=O(null!==(p=null!==(d=e.value)&&void 0!==d?d:e.defaultValue)&&void 0!==p?p:""),I=A(),E=L.useInject(),$=F(()=>M(E.status,e.status));y({prefixCls:F(()=>`${c.value}-menu`),mode:F(()=>"vertical"),selectable:F(()=>!1),onClick:()=>{},validator:e=>{let{mode:t}=e}}),z(()=>e.value,e=>{j.value=e});const T=e=>{C.value=!0,i("focus",e)},N=e=>{C.value=!1,i("blur",e),I.onFieldBlur()},R=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];i("select",...t),C.value=!0},k=t=>{void 0===e.value&&(j.value=t),i("update:value",t),i("change",t),I.onFieldChange()},B=()=>{const t=e.notFoundContent;return void 0!==t?t:n.notFoundContent?n.notFoundContent():f("Select")};u({focus:()=>{w.value.focus()},blur:()=>{w.value.blur()}});const D=F(()=>e.loading?ve:e.filterOption);return()=>{const{disabled:t,getPopupContainer:i,rows:u=1,id:d=I.id.value}=e,p=fe(e,["disabled","getPopupContainer","rows","id"]),{hasFeedback:f,feedbackIcon:v}=E,{class:y}=s,O=fe(s,["class"]),F=a(p,["defaultValue","onUpdate:value","prefixCls"]),z=r({[`${c.value}-disabled`]:t,[`${c.value}-focused`]:C.value,[`${c.value}-rtl`]:"rtl"===h.value},H(c.value,$.value),!f&&y,x.value),A=o(o(o(o({prefixCls:c.value},F),{disabled:t,direction:h.value,filterOption:D.value,getPopupContainer:i,options:e.loading?[{value:"ANTDV_SEARCHING",disabled:!0,label:P(S,{size:"small"},null)}]:e.options||g((null===(L=n.default)||void 0===L?void 0:L.call(n))||[]).map(e=>{var t,n;return o(o({},m(e)),{label:null===(n=null===(t=e.children)||void 0===t?void 0:t.default)||void 0===n?void 0:n.call(t)})}),class:z}),O),{rows:u,onChange:k,onSelect:R,onFocus:T,onBlur:N,ref:w,value:j.value,id:d});var L;const M=P(le,l(l({},A),{},{dropdownClassName:x.value}),{notFoundContent:B,option:n.option});return b(f?P("div",{class:r(`${c.value}-affix-wrapper`,H(`${c.value}-affix-wrapper`,$.value,f),y,x.value)},[M,P("span",{class:`${c.value}-suffix`},[v])]):M)}}}),he=C(o(o({compatConfig:{MODE:3}},de),{name:"AMentionsOption",props:ue})),be=o(me,{Option:he,getMentions:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{prefix:o="@",split:n=" "}=t,i=Array.isArray(o)?o:[o];return e.split(n).map(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=null;return i.some(o=>e.slice(0,o.length)===o&&(t=o,!0)),null!==t?{prefix:t,value:e.slice(t.length)}:null}).filter(e=>!!e&&!!e.value)},install:e=>(e.component(me.name,me),e.component(he.name,he),e)});export{he as MentionsOption,be as default,ge as mentionsProps};
